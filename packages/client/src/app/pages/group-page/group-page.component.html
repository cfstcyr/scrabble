<div class="page">
    <app-page-header title="Sélection de partie">
        <app-header-btn link="/game-creation" header-button>Créer une partie</app-header-btn>
    </app-page-header>

    <div class="container">
        <div class="steps">
            <div class="step" [ngClass]="{ completed: playerNameValid }">
                <div class="step-indicator">
                    <p class="indicator"><span>1</span></p>
                </div>
                <div class="step-content" id="name-input-container">
                    <mat-card>
                        <app-name-field
                            [initialPlayerName]="playerName"
                            [virtualPlayerName]="''"
                            [mustVerifyVirtualPlayerName]="false"
                            (keydown.enter)="$event.preventDefault()"
                            (playerNameChange)="onPlayerNameChanges($event)"
                        ></app-name-field>
                    </mat-card>

                    <mat-divider class="step-divider"></mat-divider>
                </div>
            </div>

            <div class="step" [ngClass]="{ disabled: !playerNameValid }">
                <div class="step-indicator">
                    <p class="indicator"><span>2</span></p>
                </div>
                <div class="step-content" id="group-container">
                    <mat-card>
                        <p *ngIf="numberOfLobbiesMeetingFilter > 0">
                            Choisissez une partie<span *ngIf="numberOfLobbiesMeetingFilter > 1"> ou rejoignez une partie aléatoire</span>.
                        </p>
                        <p *ngIf="numberOfLobbiesMeetingFilter === 0">Aucune partie disponible.</p>
                        <button
                            mat-flat-button
                            color="primary"
                            *ngIf="numberOfLobbiesMeetingFilter > 0"
                            [disabled]="numberOfLobbiesMeetingFilter <= 1 || !playerNameValid"
                            (click)="joinRandomGroup()"
                        >
                            <app-icon icon="random"></app-icon> Partie aléatoire
                        </button>
                    </mat-card>

                    <br />

                    <mat-card class="form-container">
                        <div class="info">
                            <p class="title">Filtre</p>
                            <p class="group-amount" *ngIf="numberOfLobbiesMeetingFilter > 1">{{ numberOfLobbiesMeetingFilter }} parties trouvées</p>
                            <p class="group-amount" *ngIf="numberOfLobbiesMeetingFilter === 1">{{ numberOfLobbiesMeetingFilter }} partie trouvée</p>
                            <p class="group-amount" *ngIf="numberOfLobbiesMeetingFilter === 0">Aucune partie trouvée</p>
                        </div>

                        <div class="forms">
                            <form [formGroup]="filterFormGroup">
                                <mat-form-field appearance="standard">
                                    <mat-label>Type de partie</mat-label>
                                    <mat-select formControlName="gameType">
                                        <mat-option value="all">Tous</mat-option>
                                        <mat-option value="Classique">Classique</mat-option>
                                        <mat-option value="LOG2990">LOG2990</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </form>
                        </div>
                    </mat-card>

                    <div class="grid">
                        <ng-container *ngFor="let group of groups">
                            <app-group-info [group]="group" *ngIf="group.meetFilters" (joinGroupId)="joinGroup($event)"></app-group-info>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
