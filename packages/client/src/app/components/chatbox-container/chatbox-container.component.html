<div class="chatbox-container">
    <div class="chatbox-container__chatboxes">
        <ng-container *ngFor="let channel of openedChannels">
            <app-chatbox-message 
                [title]="channel.name"
                [messages]="channel.messages"
                (onMinimize)="minimizeChannel(channel)"
                (onClose)="handleQuitChannel(channel)"
                (sendMessage)="handleSendMessage(channel, $event)"
            ></app-chatbox-message>
        </ng-container>

        <app-chatbox title="New message" (onMinimize)="closeStartChannel()" [hideIcon]="true" [hideClose]="true" *ngIf="startChannelIsOpen">
            <div class="chatbox-container__add-channel">
                <div class="chatbox-container__section">
                    <form [formGroup]="createChannelForm" (ngSubmit)="handleCreateChannel()">
                        <mat-form-field appearance="outline" class="chatbox-container__create-channel">
                            <mat-label>Cr√©er un canal</mat-label>
                            <input matInput type="text" formControlName="createChannel" #createChannelInput />
                            <button mat-icon-button matSuffix><mat-icon>add</mat-icon></button>
                        </mat-form-field>
                    </form>
                    <form [formGroup]="joinChannelForm" (ngSubmit)="handleJoinChannel()">
                        <mat-form-field appearance="outline" class="chatbox-container__create-channel">
                            <mat-label>Joindre un canal</mat-label>
                            <input matInput type="text" formControlName="joinChannel" #joinChannelInput />
                            <button mat-icon-button matSuffix><mat-icon>login</mat-icon></button>
                        </mat-form-field>
                    </form>
                </div>
                <div class="chatbox-container__section">
                    <p class="chatbox-container__section__title">Mes canaux</p>
                    <div class="chatbox-container__my-channels__content">
                        <button 
                            *ngFor="let channel of getChannelsForStartChannel()" 
                            [disabled]="!channel.canOpen"
                            (click)="showChannel(channel)"
                            class="chatbox-container__my-channels__button"
                        >
                            {{channel.name}}
                        </button>
                    </div>
                </div>
            </div>
        </app-chatbox>
    </div>

    <button mat-fab color="white" class="chatbox-container__button" (click)="toggleStartChannel()">
        <app-icon icon="edit" styling="solid"></app-icon>
    </button>
</div>