<app-chatbox 
    [title]="title" 
    [icon]="getLastUsersAvatarUrl()[0] ?? ''" 
    [icon2]="getLastUsersAvatarUrl()[1] ?? ''" 
    class="chatbox-message"
>
    <ng-container action-button>
        <ng-content select="[action-button]"></ng-content>
    </ng-container>

    <div class="chatbox-message__content">
        <div class="chatbox-message__messages">
            <div class="chatbox-message__messages__container">
                <div *ngFor="let messageGroup of getMessages()" [ngClass]="{'chatbox-message__group': true, 'chatbox-message__group--is-current-user': messageGroup.isCurrentUser, 'chatbox-message__group--is-other-user': !messageGroup.isCurrentUser}">
                    <p class="chatbox-message__group__username">{{messageGroup.sender.username}}</p>
                    <div class="chatbox-message__group__content">
                        <img 
                            class="chatbox-message__group__avatar"
                            [src]="messageGroup.sender.avatar" 
                            *ngIf="!messageGroup.isCurrentUser"
                        />
                        <div class="chatbox-message__group__messages">
                            <p *ngFor="let message of messageGroup.messages" [ngClass]="{'chatbox-message__message': true, 'chatbox-message__message--only-emoji': onlyHasEmoji(message)}">{{message}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="chatbox-message__input">
            <form class="chatbox-message__input__form" [formGroup]="messageForm" (ngSubmit)="onMessageSubmit()" novalidate>
                <input type="text" formControlName="message" class="chatbox-message__input__form__control" placeholder="Aa" [maxlength]="512">
            </form>
    
            <app-icon-button (click)="onEmojiClick('👍')">👍</app-icon-button>
        </div>
    </div>
</app-chatbox>